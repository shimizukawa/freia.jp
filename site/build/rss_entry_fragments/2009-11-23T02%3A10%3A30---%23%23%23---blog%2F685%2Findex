(dp0
S'pubdate'
p1
cdatetime
datetime
p2
(S'\x07\xd9\x0b\x17\x02\n\x1e\x00\x00\x00'
p3
tp4
Rp5
sS'link'
p6
Vhttp://www.freia.jp/taka/blog/685/index.html
p7
sS'description'
p8
V<div id=web-plone-2-5-2-1-plone-3-3-2 class=section>\u000a<h1>2009/11/23 \u6e05\u6c34\u5dddWeb\u3092 Plone-2.5.2-1 \u304b\u3089 Plone-3.3.2 \u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#web-plone-2-5-2-1-plone-3-3-2 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h1>\u000a<p><em>Category: 'Plone'</em></p>\u000a<p>\u3053\u306e\u30b5\u30a4\u30c8\u306e Plone \u3092 <cite>Plone 2.5.2-1</cite> \u304b\u3089 <cite>Plone 3.3</cite> \u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u3088\u3046\u3068\u5148\u6708\u304b\u3089\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u3064\u3044\u306b\u6210\u529f\u3057\u305f\u306e\u3067\u305d\u306e\u624b\u9806\u3092\u6df1\u3044\u8003\u5bdf\u306a\u3069\u305b\u305a\u306b\u305d\u306e\u307e\u3093\u307e\u516c\u958b\u3057\u307e\u3059\u3002\u300c\u3059\u304f\u306a\u304f\u3068\u3082\u3046\u3061\u306e\u30b5\u30a4\u30c8\u306f\u3053\u308c\u3067\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\u300d\u7684\u306a\u5185\u5bb9\u306a\u306e\u3067\u3001\u3082\u3057\u304b\u3057\u305f\u3089\u3001\u3042\u3093\u307e\u308a\u5f79\u306b\u7acb\u305f\u306a\u3044\u304b\u3082\u77e5\u308c\u307e\u305b\u3093\u3002</p>\u000a<p>\u306a\u304a\u3001\u307e\u3060\u300c\u8a66\u884c\u932f\u8aa4\u3057\u305f\u7d50\u679c\u3046\u307e\u304f\u3044\u3063\u305f\u300d\u72b6\u614b\u3067\u3001\u30c7\u30b6\u30a4\u30f3\u306a\u3069\u3082\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u672c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3092\u9069\u7528\u3057\u3066\u30b5\u30a4\u30c8\u516c\u958b\u3059\u308b\u306e\u306f\u3082\u3046\u3061\u3087\u3063\u3068\u5148\u306b\u306a\u308a\u305d\u3046\u3067\u3059\u3002</p>\u000a<p>\u8a73\u7d30\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002</p>\u000a<div id=zope-2-9-7-2-10-9 class=section>\u000a<h2>Zope 2.9.7 -&gt; 2.10.9<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#zope-2-9-7-2-10-9 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>Plone3\u7cfb\u306b\u3059\u308b\u306b\u306fZope-2.10.x\u304c\u5fc5\u8981\u306a\u306e\u3067\u3001\u5148\u306bZope\u672c\u4f53\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4e0a\u3052\u3066\u304a\u304f\u3002</p>\u000a<p>from:</p>\u000a<div class=highlight-python><pre>Plone 2.5.2,\u000aCMF-1.6.2,\u000aZope (Zope 2.9.7-final, python 2.4.4, freebsd7),\u000aFive 1.3.8,\u000aPython 2.4.4 (#2, Oct 26 2008, 05:45:29) [GCC 4.2.1 20070719 [FreeBSD]],\u000aPIL 1.1.6</pre>\u000a</div>\u000a<p>to:</p>\u000a<div class=highlight-python><pre>Plone 2.5.2,\u000aCMF-1.6.2,\u000aZope (Zope 2.10.9-final, python 2.4.4, freebsd7),\u000aFive 1.5.6,\u000aPython 2.4.4 (#2, Oct 26 2008, 05:45:29) [GCC 4.2.1 20070719 [FreeBSD]],\u000aPIL 1.1.6</pre>\u000a</div>\u000a</div>\u000a<div id=plone-2-5-2-1-2-5-5 class=section>\u000a<h2>Plone 2.5.2-1 -&gt; 2.5.5<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#plone-2-5-2-1-2-5-5 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>\u306a\u3093\u306b\u3082\u554f\u984c\u7121\u304b\u3063\u305f\u306f\u305a\u3002\u7701\u7565\u3057\u3066 2.5.2 -&gt; 3.1.7 \u306b\u3057\u3066\u3082\u826f\u3044\u304b\u3082\u3002</p>\u000a</div>\u000a<div id=plone-2-5-5-3-1-7 class=section>\u000a<h2>Plone 2.5.5 -&gt; 3.1.7<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#plone-2-5-5-3-1-7 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>Plone3\u7cfb\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3002Plone-3.2\u7cfb\u306ftgz\u30d1\u30c3\u30b1\u30fc\u30b8\u914d\u5e03\u304b\u3089buildout\u306b\u5207\u308a\u66ff\u308f\u3063\u3066\u3044\u308b\u306e\u3067\u3001tgz\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3067\u304d\u308b\u306e\u306f3.1.7\u307e\u3067\u3002\u3068\u308a\u3042\u3048\u305a\u3053\u3053\u307e\u3067\u306f\u5f93\u6765\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u624b\u9806\u3067\u4e0a\u3052\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u3059\u308b\u3002</p>\u000a<p>Products\u3092Plone-3.1.7\u306b\u66f4\u65b0\u3057\u3066\u8d77\u52d5\u3059\u308b\u3068\u3001import\u30a8\u30e9\u30fc\u304c\u305f\u304f\u3055\u3093\u767a\u751f\u3059\u308b\u3002\u000a\u3053\u3053\u3067\u3053\u306e\u30a8\u30e9\u30fc\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u3001Plone\u4ee5\u5916\u306b\u5165\u308c\u3066\u3044\u308b\u30d7\u30ed\u30c0\u30af\u30c8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u6539\u9020\u3092\u5b9f\u65bd\u3002</p>\u000a<ul>\u000a<li><p class=first>\u8907\u6570\u306e\u30d7\u30ed\u30c0\u30af\u30c8\u3067\u3001 <tt class="docutils literal"><span class=pre>Products.CMFCore.CMFCorePermissions</span></tt> \u304c\u898b\u3064\u304b\u3089\u306a\u3044\u30a8\u30e9\u30fc\u304c\u30dc\u30ed\u30dc\u30ed\u3068\u51fa\u3066\u304d\u305f\u306e\u3067\u3001 Products.CMFCore.permissions \u306b\u7f6e\u304d\u63db\u3048\u305f\u3002\u3053\u3093\u306a\u304b\u3093\u3058:</p>\u000a<div class=highlight-python><pre>-from Products.CMFCore.CMFCorePermissions import View,ListFolderContents,\u005c\u000a+from Products.CMFCore.permissions import View,ListFolderContents,\u005c</pre>\u000a</div>\u000a</li>\u000a<li><p class=first><tt class="docutils literal"><span class=pre>Products.CMFCore.WorkflowCore.WorkflowAction</span></tt> \u304c\u898b\u3064\u304b\u3089\u306a\u3044\u3002\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u6539\u9020\u3057\u3066\u307f\u305f:</p>\u000a<div class=highlight-python><pre>-from TAL.TALDefs import TALESError\u000a+#from TAL.TALDefs import TALESError\u000a+from zope.tal.taldefs import TALExpressionError as TALESError\u000a from Products.CMFDefault.DublinCore import DefaultDublinCoreImpl\u000a from Products.CMFCore.PortalContent import PortalContent\u000a-from Products.CMFCore.PortalContent import NoWL, ResourceLockedError\u000a-from Products.CMFCore.WorkflowCore import WorkflowAction\u000a+from Products.CMFCore.PortalContent import ResourceLockedError\u000a+NoWL = 0\u000a\u000a\u305d\u3057\u3066\u5b9f\u969b\u306bWorkflowAction\u3092\u4f7f\u3063\u3066\u308b\u884c\u3067...\u000a\u000a-    setFormat = WorkflowAction(setFormat)\u000a+    #setFormat = WorkflowAction(setFormat)\u000a\u000a\u3053\u308c\u306f\u79fb\u884c\u5f8c\u306b\u3069\u3046\u3059\u308b\u304b\u8003\u3048\u3088\u3046...</pre>\u000a</div>\u000a</li>\u000a<li><p class=first>Products.PluggableAuthService.utils.implementedBy \u304c\u7121\u3044:</p>\u000a<div class=highlight-python><pre>-from Products.PluggableAuthService.utils import implementedBy\u000a+from zope.interface import implementedBy</pre>\u000a</div>\u000a</li>\u000a</ul>\u000a<p>\u8d77\u52d5\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067 portal_migration \u3092dry-run\u3059\u308b\u3068\u3001\u306a\u3093\u304b <cite>PT:Document</cite> \u304c\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u51fa\u6765\u306a\u3044\u3068\u8a00\u308f\u308c\u308b:</p>\u000a<div class=highlight-python><pre>2009-11-22 21:24:50 INFO Plone\u000aAttempting to upgrade from: 2.5.5\u000a2009-11-22 21:24:50 ERROR Plone\u000aUpgrade aborted\u000a2009-11-22 21:24:50 ERROR Plone\u000aError type: zExceptions.BadRequest\u000a2009-11-22 21:24:50 ERROR Plone\u000aError value: The id "PT:Document" contains characters illegal in URLs.\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/ZFreia_taka/Plone-3.1.7/Products/CMFPlone/MigrationTool.py", line 210, in upgrade\u000a    newv, msgs = self._upgrade(newv)\u000a\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/ZFreia_taka/Plone-3.1.7/Products/CMFPlone/MigrationTool.py", line 321, in _upgrade\u000a    res = function(self.aq_parent)\u000a\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/ZFreia_taka/Plone-3.1.7/Products/CMFPlone/migrations/v3_0/alphas.py", line 100, in three0_alpha1\u000a    migrateOldActions(portal, out)\u000a\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/ZFreia_taka/Plone-3.1.7/Products/CMFPlone/migrations/v3_0/alphas.py", line 425, in migrateOldActions\u000a    portal.portal_actions._setObject(category, ActionCategory(id=category))\u000a\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/Zope210/lib/python/OFS/ObjectManager.py", line 315, in _setObject\u000a    v = self._checkId(id)\u000a\u000a2009-11-22 21:24:50 ERROR Plone\u000a  File "/usr/local/www/Zope210/lib/python/OFS/ObjectManager.py", line 83, in checkValidId\u000a    raise BadRequest, (\u000a\u000a2009-11-22 21:24:50 INFO Plone\u000aEnd of upgrade path, migration has finished\u000a2009-11-22 21:24:50 ERROR Plone\u000aThe upgrade path did NOT reach current version\u000a2009-11-22 21:24:50 ERROR Plone\u000aMigration has failed\u000a2009-11-22 21:24:50 INFO Plone\u000aDry run selected, transaction aborted</pre>\u000a</div>\u000a<p>\u305d\u3053\u3067\u3001portal_contentpanels\u3092uninstall\u3057\u3088\u3046\u3068\u3057\u305f\u3089\u305d\u308c\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u307e\u3042\u3044\u3044\u3084\u3001\u3068\u601d\u3063\u3066portal/portal_contentpanels\u3092\u524a\u9664\u3002\u672c\u756a\u3067\u306f\u4e8b\u524d\u306bCMFContentPanels\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304d\u305f\u3044\u3002\u6539\u3081\u3066dry-run\u3092\u5b9f\u884c\u3057\u305f\u3068\u3053\u308d\u3046\u307e\u304f\u3044\u3063\u305f\u3063\u307d\u3044:</p>\u000a<div class=highlight-python><pre>Plone Migration Tool at  /freia/taka/portal_migration\u000aResult of the attempt...\u000a\u000aDry run selected.\u000aStarting the migration from version: 2.5.5\u000aAttempting to upgrade from: 2.5.5\u000aRegistered tools as utilities.\u000aMigrated old actions to new actions stored in portal_actions.\u000aAdded navtree.css to the registry\u000aAdded invisibles.css to the registry\u000aAdded forms.css to the registry\u000aAdded 'default_contenttype' property to site_properties.\u000aAdded 'forbidden_contenttypes' property to site_properties.\u000aAdded Markup Settings to the control panel\u000aAdded markup configlet icon to actionicons tool.\u000aUpdated actions i18n domain attribute.\u000aUpdated type informations i18n domain attribute.\u000aUpgraded the ATContentTypes tool.\u000aInstalled CMFDiffTool.\u000aInstalled CMFEditions.\u000aConverted legacy portlets at the portal root\u000aNOTE: You may need to convert other portlets manually.\u000a- to do so, click "manage portlets" in the relevant folder.\u000aAdded 'calendar' icon to actionicons tool.\u000aAdded calendar settings to the control panel\u000aRemoved the Plone Tableless skin\u000aUpgrade to: 3.0-alpha1, completed\u000aAttempting to upgrade from: 3.0-alpha1\u000aRegistered tools as utilities.\u000aRemoved generated.css from the registry\u000aAdded form_tabbing.js to portal_javascipt\u000aRegistered kss mimetype\u000aRegistered kss resources\u000aAdded missing skins to Plone Default\u000aSuccesfully migrated portal to KSS\u000aRegistered redirector utility\u000aAdded content rules action to object category\u000aAdded reader and editor roles\u000aEnsured references to folder_localrole_form point to @@sharing now\u000aUpdated RTL.css expression.\u000aUpgrade to: 3.0-alpha2, completed\u000aAttempting to upgrade from: 3.0-alpha2\u000aRegistered tools as utilities.\u000aAdded 'Maintenance' to the control panel\u000aAdded 'maintenance' icon to actionicons tool.\u000aAdded 'number_of_days_to_keep' property to site properties\u000aAdded 's5_presentation' action to actions tool.\u000aAdded 's5_presentation' icon to actionicons tool.\u000aAdded in css and js for table of contents\u000aAdded input-label.js to portal_javascipt\u000aUpdated member management security\u000aAdded Plone Session Plugin.\u000aAdded 'filter' icon to actionicons tool.\u000aAdded 'security' icon to actionicons tool.\u000aRegistered content rules storage utility\u000aAdded 'Content Rules Settings' to the control panel\u000aAdded 'Content Rules Settings' icon to actionicons tool.\u000aAdded html filter settings to the control panel\u000aAdded security settings to the control panel\u000aAdded 'enable_sitemap' property to site properties\u000aUse ++resource++kukit-src.js instead of ++resource++kukit.js\u000aSet 'full' compression on ++resource++kukit-src.js\u000aCreated RAMCache ResourceRegistryCache for ResourceRegistry output\u000aAssociated portal_css with ResourceRegistryCache\u000aAssociated portal_javascripts with ResourceRegistryCache\u000aSet 'full-encode' compression on cssQuery.js\u000aRemoved folder_contents_hideAddItems.js from portal_javascripts.\u000aAdded webstats.js to portal_javascipts\u000aAdded 'webstats_js' property to site properties\u000aAdded object_provides index to portal_catalog\u000aRemoved the mystuff user action\u000aAdded 'external_links_open_new_window' property to site properties\u000aAdded Types Settings to the control panel\u000aAdded types configlet icon to actionicons tool.\u000aAdded workflow intranet_workflow\u000aAdded workflow intranet_folder_workflow\u000aAdded workflow one_state_workflow\u000aAdded workflow simple_publication_workflow\u000aAdded 'many_groups' property to site properties\u000aReplaced obsolete PlonePAS version of plone tool with the normal one.\u000aRegistered plone.app.i18n utilities.\u000aInstalled PloneLanguageTool.\u000aAdded 'email_charset' property to the portal.\u000aUpgrade to: 3.0-beta1, completed\u000aAttempting to upgrade from: 3.0-beta1\u000aRegistered tools as utilities.\u000aChanged the order of action providers.\u000aAdded unlockOnFormUnload.js to portal_javascripts\u000aRemoved object_tabs action category.\u000aRemoved global action category.\u000aRemoved empty default_charset portal property\u000aAdded automatic group PAS plugin\u000aRemoved 's5_presentation' action from actions tool.\u000aRemoved 's5_presentation' icon from actionicons tool.\u000aAssociated portal_kss with ResourceRegistryCache\u000aUpdated kss javascript resource ++resource++kukit-src.js, to disable kss for anonymous.\u000aAdded kss resource at_experimental.kss, disabled by default.\u000aAdded kss resource plone_experimental.kss, disabled by default.\u000aRemoved properties action from type CMF Image\u000aRemoved properties action from type CMF Document\u000aRemoved properties action from type CMF Favorite\u000aRemoved properties action from type CMF Link\u000aRemoved properties action from type CMF News Item\u000aRemoved properties action from type CMF File\u000aRemoved properties action from type Wiki Page\u000aRemoved properties action from type SilverCityDocument\u000aRemoved properties action from type ATBookshelfItem\u000aRemoved properties action from type ATBookshelf\u000aRemoved properties action from type DynamicDocument\u000aRemoved properties action from type ContentPanels\u000aRemoved properties action from type ATExtFlash\u000aRemoved properties action from type COREBlog2\u000aRemoved properties action from type COREBlogComment\u000aRemoved properties action from type COREBlogTrackback\u000aRemoved properties action from type COREBlogCommentFolder\u000aRemoved properties action from type COREBlogCategory\u000aRemoved properties action from type COREBlogCategoryFolder\u000aRemoved properties action from type COREBlogEntry\u000aRemoved properties action from type ATPathCriterion\u000aRemoved properties action from type ATBooleanCriterion\u000aRemoved properties action from type Image\u000aRemoved properties action from type Topic\u000aRemoved properties action from type ATSelectionCriterion\u000aRemoved properties action from type Large Plone Folder\u000aRemoved properties action from type Document\u000aRemoved properties action from type ATSimpleStringCriterion\u000aRemoved properties action from type ATCurrentAuthorCriterion\u000aRemoved properties action from type ATDateCriteria\u000aRemoved properties action from type Favorite\u000aRemoved properties action from type Event\u000aRemoved properties action from type ATReferenceCriterion\u000aRemoved properties action from type ATSimpleIntCriterion\u000aRemoved properties action from type ATListCriterion\u000aRemoved properties action from type Folder\u000aRemoved properties action from type Link\u000aRemoved properties action from type News Item\u000aRemoved properties action from type File\u000aRemoved properties action from type ATDateRangeCriterion\u000aRemoved properties action from type ATSortCriterion\u000aRemoved properties action from type ATRelativePathCriterion\u000aRemoved properties action from type ATPortalTypeCriterion\u000aUpgrade to: 3.0-beta2, completed\u000aAttempting to upgrade from: 3.0-beta2\u000aRegistered tools as utilities.\u000aRemoved explicit references to sharing action\u000aUpgrade to: 3.0-beta3, completed\u000aAttempting to upgrade from: 3.0-beta3\u000aRegistered tools as utilities.\u000aUpdated kss javascript resources, to enable the use of production and development versions.\u000aUpgrade to: 3.0-rc1, completed\u000aAttempting to upgrade from: 3.0-rc1\u000aAdded text_web_intelligent mime type to registry\u000aAdded intelligenttext to html transform to registry\u000aAdded html to intelligenttext transform to registry\u000aUpgrade to: 3.0-rc2, completed\u000aAttempting to upgrade from: 3.0-rc2\u000aUpgrade to: 3.0, completed\u000aAttempting to upgrade from: 3.0\u000aUpgrade to: 3.0.1, completed\u000aAttempting to upgrade from: 3.0.1\u000aUpgrade to: 3.0.2, completed\u000aAttempting to upgrade from: 3.0.2\u000aUpgrade to: 3.0.3, completed\u000aAttempting to upgrade from: 3.0.3\u000aAdded new CMFEditions modifiers\u000aUpgrade to: 3.0.4, completed\u000aAttempting to upgrade from: 3.0.4\u000aRegistered tools as utilities.\u000aUpgrade to: 3.0.5, completed\u000aAttempting to upgrade from: 3.0.5\u000aUpgrade to: 3.0.6, completed\u000aAttempting to upgrade from: 3.0.6\u000aInstalled plone.browserlayer\u000aInstalled plone.portlet.static\u000aInstalled plone.portlet.collection\u000aMigrated portlet types to support multiple portlet manager interfaces.\u000aRemoved doubly registered GenericSetup import steps: toolset rolemap componentregistry\u000aRemoved doubly registered GenericSetup export steps: componentregistry step_registries rolemap toolset\u000aReinstalled CMFPlacefulWorkflow\u000aDeactivated original 'local_roles' plugin\u000a- Activating: local_roles borg_localroles activated.\u000aUpgrade to: 3.1-beta1, completed\u000aAttempting to upgrade from: 3.1-beta1\u000aUpgrade to: 3.1-rc1, completed\u000aAttempting to upgrade from: 3.1-rc1\u000aUpgrade to: 3.1, completed\u000aAttempting to upgrade from: 3.1\u000aUpgrade to: 3.1.1, completed\u000aAttempting to upgrade from: 3.1.1\u000aUpgrade to: 3.1.2, completed\u000aAttempting to upgrade from: 3.1.2\u000aUpgrade to: 3.1.3, completed\u000aAttempting to upgrade from: 3.1.3\u000aUpgrade to: 3.1.4, completed\u000aAttempting to upgrade from: 3.1.4\u000aUpgrade to: 3.1.5, completed\u000aAttempting to upgrade from: 3.1.5\u000aUpgrade to: 3.1.5.1, completed\u000aAttempting to upgrade from: 3.1.5.1\u000aUpgrade to: 3.1.6, completed\u000aAttempting to upgrade from: 3.1.6\u000aUpgrade to: 3.1.7, completed\u000aAttempting to upgrade from: 3.1.7\u000aMigration completed at version 3.1.7.\u000aEnd of upgrade path, migration has finished\u000aYour ZODB and Filesystem Plone instances are now up-to-date.\u000aDry run selected, transaction aborted\u000aReturn</pre>\u000a</div>\u000a<p>\u6700\u5f8c\u306b aborted \u306b\u306a\u3063\u3066\u3044\u308b\u306e\u306fdry-run\u3092\u3057\u305f\u305f\u3081\u3002\u305d\u308c\u3067\u306f\u6539\u3081\u3066\u672c\u5b9f\u884c:</p>\u000a<div class=highlight-python><pre>Plone Migration Tool at  /freia/taka/portal_migration\u000aResult of the attempt...\u000a\u000aStarting the migration from version: 2.5.5\u000aAttempting to upgrade from: 2.5.5\u000aRegistered tools as utilities.\u000aMigrated old actions to new actions stored in portal_actions.\u000aAdded navtree.css to the registry\u000aAdded invisibles.css to the registry\u000aAdded forms.css to the registry\u000aAdded 'default_contenttype' property to site_properties.\u000aAdded 'forbidden_contenttypes' property to site_properties.\u000aAdded Markup Settings to the control panel\u000aAdded markup configlet icon to actionicons tool.\u000aUpdated actions i18n domain attribute.\u000aUpdated type informations i18n domain attribute.\u000aUpgraded the ATContentTypes tool.\u000aInstalled CMFDiffTool.\u000aInstalled CMFEditions.\u000aConverted legacy portlets at the portal root\u000aNOTE: You may need to convert other portlets manually.\u000a- to do so, click "manage portlets" in the relevant folder.\u000aAdded 'calendar' icon to actionicons tool.\u000aAdded calendar settings to the control panel\u000aRemoved the Plone Tableless skin\u000aUpgrade to: 3.0-alpha1, completed\u000aAttempting to upgrade from: 3.0-alpha1\u000aRegistered tools as utilities.\u000aRemoved generated.css from the registry\u000aAdded form_tabbing.js to portal_javascipt\u000aRegistered kss mimetype\u000aRegistered kss resources\u000aAdded missing skins to Plone Default\u000aSuccesfully migrated portal to KSS\u000aRegistered redirector utility\u000aAdded content rules action to object category\u000aAdded reader and editor roles\u000aEnsured references to folder_localrole_form point to @@sharing now\u000aUpdated RTL.css expression.\u000aUpgrade to: 3.0-alpha2, completed\u000aAttempting to upgrade from: 3.0-alpha2\u000aRegistered tools as utilities.\u000aAdded 'Maintenance' to the control panel\u000aAdded 'maintenance' icon to actionicons tool.\u000aAdded 'number_of_days_to_keep' property to site properties\u000aAdded 's5_presentation' action to actions tool.\u000aAdded 's5_presentation' icon to actionicons tool.\u000aAdded in css and js for table of contents\u000aAdded input-label.js to portal_javascipt\u000aUpdated member management security\u000aAdded Plone Session Plugin.\u000aAdded 'filter' icon to actionicons tool.\u000aAdded 'security' icon to actionicons tool.\u000aRegistered content rules storage utility\u000aAdded 'Content Rules Settings' to the control panel\u000aAdded 'Content Rules Settings' icon to actionicons tool.\u000aAdded html filter settings to the control panel\u000aAdded security settings to the control panel\u000aAdded 'enable_sitemap' property to site properties\u000aUse ++resource++kukit-src.js instead of ++resource++kukit.js\u000aSet 'full' compression on ++resource++kukit-src.js\u000aCreated RAMCache ResourceRegistryCache for ResourceRegistry output\u000aAssociated portal_css with ResourceRegistryCache\u000aAssociated portal_javascripts with ResourceRegistryCache\u000aSet 'full-encode' compression on cssQuery.js\u000aRemoved folder_contents_hideAddItems.js from portal_javascripts.\u000aAdded webstats.js to portal_javascipts\u000aAdded 'webstats_js' property to site properties\u000aAdded object_provides index to portal_catalog\u000aRemoved the mystuff user action\u000aAdded 'external_links_open_new_window' property to site properties\u000aAdded Types Settings to the control panel\u000aAdded types configlet icon to actionicons tool.\u000aAdded workflow intranet_workflow\u000aAdded workflow intranet_folder_workflow\u000aAdded workflow one_state_workflow\u000aAdded workflow simple_publication_workflow\u000aAdded 'many_groups' property to site properties\u000aReplaced obsolete PlonePAS version of plone tool with the normal one.\u000aRegistered plone.app.i18n utilities.\u000aInstalled PloneLanguageTool.\u000aAdded 'email_charset' property to the portal.\u000aUpgrade to: 3.0-beta1, completed\u000aAttempting to upgrade from: 3.0-beta1\u000aRegistered tools as utilities.\u000aChanged the order of action providers.\u000aAdded unlockOnFormUnload.js to portal_javascripts\u000aRemoved object_tabs action category.\u000aRemoved global action category.\u000aRemoved empty default_charset portal property\u000aAdded automatic group PAS plugin\u000aRemoved 's5_presentation' action from actions tool.\u000aRemoved 's5_presentation' icon from actionicons tool.\u000aAssociated portal_kss with ResourceRegistryCache\u000aUpdated kss javascript resource ++resource++kukit-src.js, to disable kss for anonymous.\u000aAdded kss resource at_experimental.kss, disabled by default.\u000aAdded kss resource plone_experimental.kss, disabled by default.\u000aRemoved properties action from type CMF Image\u000aRemoved properties action from type CMF Document\u000aRemoved properties action from type CMF Favorite\u000aRemoved properties action from type CMF Link\u000aRemoved properties action from type CMF News Item\u000aRemoved properties action from type CMF File\u000aRemoved properties action from type Wiki Page\u000aRemoved properties action from type SilverCityDocument\u000aRemoved properties action from type ATBookshelfItem\u000aRemoved properties action from type ATBookshelf\u000aRemoved properties action from type DynamicDocument\u000aRemoved properties action from type ContentPanels\u000aRemoved properties action from type ATExtFlash\u000aRemoved properties action from type COREBlog2\u000aRemoved properties action from type COREBlogComment\u000aRemoved properties action from type COREBlogTrackback\u000aRemoved properties action from type COREBlogCommentFolder\u000aRemoved properties action from type COREBlogCategory\u000aRemoved properties action from type COREBlogCategoryFolder\u000aRemoved properties action from type COREBlogEntry\u000aRemoved properties action from type ATPathCriterion\u000aRemoved properties action from type ATBooleanCriterion\u000aRemoved properties action from type Image\u000aRemoved properties action from type Topic\u000aRemoved properties action from type ATSelectionCriterion\u000aRemoved properties action from type Large Plone Folder\u000aRemoved properties action from type Document\u000aRemoved properties action from type ATSimpleStringCriterion\u000aRemoved properties action from type ATCurrentAuthorCriterion\u000aRemoved properties action from type ATDateCriteria\u000aRemoved properties action from type Favorite\u000aRemoved properties action from type Event\u000aRemoved properties action from type ATReferenceCriterion\u000aRemoved properties action from type ATSimpleIntCriterion\u000aRemoved properties action from type ATListCriterion\u000aRemoved properties action from type Folder\u000aRemoved properties action from type Link\u000aRemoved properties action from type News Item\u000aRemoved properties action from type File\u000aRemoved properties action from type ATDateRangeCriterion\u000aRemoved properties action from type ATSortCriterion\u000aRemoved properties action from type ATRelativePathCriterion\u000aRemoved properties action from type ATPortalTypeCriterion\u000aUpgrade to: 3.0-beta2, completed\u000aAttempting to upgrade from: 3.0-beta2\u000aRegistered tools as utilities.\u000aRemoved explicit references to sharing action\u000aUpgrade to: 3.0-beta3, completed\u000aAttempting to upgrade from: 3.0-beta3\u000aRegistered tools as utilities.\u000aUpdated kss javascript resources, to enable the use of production and development versions.\u000aUpgrade to: 3.0-rc1, completed\u000aAttempting to upgrade from: 3.0-rc1\u000aAdded text_web_intelligent mime type to registry\u000aAdded intelligenttext to html transform to registry\u000aAdded html to intelligenttext transform to registry\u000aUpgrade to: 3.0-rc2, completed\u000aAttempting to upgrade from: 3.0-rc2\u000aUpgrade to: 3.0, completed\u000aAttempting to upgrade from: 3.0\u000aUpgrade to: 3.0.1, completed\u000aAttempting to upgrade from: 3.0.1\u000aUpgrade to: 3.0.2, completed\u000aAttempting to upgrade from: 3.0.2\u000aUpgrade to: 3.0.3, completed\u000aAttempting to upgrade from: 3.0.3\u000aAdded new CMFEditions modifiers\u000aUpgrade to: 3.0.4, completed\u000aAttempting to upgrade from: 3.0.4\u000aRegistered tools as utilities.\u000aUpgrade to: 3.0.5, completed\u000aAttempting to upgrade from: 3.0.5\u000aUpgrade to: 3.0.6, completed\u000aAttempting to upgrade from: 3.0.6\u000aInstalled plone.browserlayer\u000aInstalled plone.portlet.static\u000aInstalled plone.portlet.collection\u000aMigrated portlet types to support multiple portlet manager interfaces.\u000aRemoved doubly registered GenericSetup import steps: toolset rolemap componentregistry\u000aRemoved doubly registered GenericSetup export steps: componentregistry step_registries rolemap toolset\u000aReinstalled CMFPlacefulWorkflow\u000aDeactivated original 'local_roles' plugin\u000a- Activating: local_roles borg_localroles activated.\u000aUpgrade to: 3.1-beta1, completed\u000aAttempting to upgrade from: 3.1-beta1\u000aUpgrade to: 3.1-rc1, completed\u000aAttempting to upgrade from: 3.1-rc1\u000aUpgrade to: 3.1, completed\u000aAttempting to upgrade from: 3.1\u000aUpgrade to: 3.1.1, completed\u000aAttempting to upgrade from: 3.1.1\u000aUpgrade to: 3.1.2, completed\u000aAttempting to upgrade from: 3.1.2\u000aUpgrade to: 3.1.3, completed\u000aAttempting to upgrade from: 3.1.3\u000aUpgrade to: 3.1.4, completed\u000aAttempting to upgrade from: 3.1.4\u000aUpgrade to: 3.1.5, completed\u000aAttempting to upgrade from: 3.1.5\u000aUpgrade to: 3.1.5.1, completed\u000aAttempting to upgrade from: 3.1.5.1\u000aUpgrade to: 3.1.6, completed\u000aAttempting to upgrade from: 3.1.6\u000aUpgrade to: 3.1.7, completed\u000aAttempting to upgrade from: 3.1.7\u000aMigration completed at version 3.1.7.\u000aEnd of upgrade path, migration has finished\u000aYour ZODB and Filesystem Plone instances are now up-to-date.</pre>\u000a</div>\u000a<p>\u3046\u3049\u3001\u6210\u529f\u3057\u305f\uff01\u000a\u3057\u304b\u3057Plone\u306eView\u3067\u8868\u793a\u3057\u3088\u3046\u3068\u3057\u305f\u3089\u30a8\u30e9\u30fc:</p>\u000a<div class=highlight-python><pre>2009-11-22 21:38:13 ERROR Zope.SiteErrorLog 1258893493.510.109067702822 http://192.168.1.2:8980/freia/taka/folder_listing\u000aTraceback (innermost last):\u000a  Module ZPublisher.Publish, line 119, in publish\u000a  Module ZPublisher.mapply, line 88, in mapply\u000a  Module ZPublisher.Publish, line 42, in call_object\u000a  Module Shared.DC.Scripts.Bindings, line 313, in __call__\u000a  Module Shared.DC.Scripts.Bindings, line 350, in _bindAndExec\u000a  Module Products.CMFCore.FSPageTemplate, line 216, in _exec\u000a  Module Products.CMFCore.FSPageTemplate, line 155, in pt_render\u000a  Module Products.PageTemplates.PageTemplate, line 98, in pt_render\u000a  Module zope.pagetemplate.pagetemplate, line 117, in pt_render\u000a   - Warning: Macro expansion failed\u000a   - Warning: exceptions.KeyError: 'kss_generic_macros'\u000a  Module zope.tal.talinterpreter, line 271, in __call__\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 891, in do_useMacro\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 536, in do_optTag_tal\u000a  Module zope.tal.talinterpreter, line 521, in do_optTag\u000a  Module zope.tal.talinterpreter, line 516, in no_tag\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 957, in do_defineSlot\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 536, in do_optTag_tal\u000a  Module zope.tal.talinterpreter, line 521, in do_optTag\u000a  Module zope.tal.talinterpreter, line 516, in no_tag\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 861, in do_defineMacro\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 957, in do_defineSlot\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 536, in do_optTag_tal\u000a  Module zope.tal.talinterpreter, line 521, in do_optTag\u000a  Module zope.tal.talinterpreter, line 516, in no_tag\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 536, in do_optTag_tal\u000a  Module zope.tal.talinterpreter, line 525, in do_optTag\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 949, in do_defineSlot\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 861, in do_defineMacro\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 536, in do_optTag_tal\u000a  Module zope.tal.talinterpreter, line 521, in do_optTag\u000a  Module zope.tal.talinterpreter, line 516, in no_tag\u000a  Module zope.tal.talinterpreter, line 346, in interpret\u000a  Module zope.tal.talinterpreter, line 870, in do_useMacro\u000a  Module zope.tales.tales, line 696, in evaluate\u000a   - URL: file:/usr/local/www/ZFreia_taka/Plone-3.1.7/Products/CMFPlone/skins/plone_content/folder_listing.pt\u000a   - Line 19, Column 8\u000a   - Expression: &lt;PathExpr standard:u'here/kss_generic_macros/macros/generic_title_view'&gt;\u000a   - Names:\u000a      {'container': &lt;PloneSite at /freia/taka&gt;,\u000a       'context': &lt;PloneSite at /freia/taka&gt;,\u000a       'default': &lt;object object at 0x80110f200&gt;,\u000a       'here': &lt;PloneSite at /freia/taka&gt;,\u000a       'loop': {},\u000a       'nothing': None,\u000a       'options': {'args': ()},\u000a       'repeat': &lt;Products.PageTemplates.Expressions.SafeMapping object at 0x81433eea8&gt;,\u000a       'request': &lt;HTTPRequest, URL=http://192.168.1.2:8980/freia/taka/folder_listing&gt;,\u000a       'root': &lt;Application at &gt;,\u000a       'template': &lt;FSPageTemplate at /freia/taka/folder_listing&gt;,\u000a       'traverse_subpath': [],\u000a       'user': &lt;PloneUser 'taka'&gt;}\u000a  Module zope.tales.expressions, line 217, in __call__\u000a  Module Products.PageTemplates.Expressions, line 155, in _eval\u000a  Module zope.tales.expressions, line 124, in _eval\u000a  Module Products.PageTemplates.Expressions, line 82, in boboAwareZopeTraverse\u000a  Module OFS.Traversable, line 301, in restrictedTraverse\u000a  Module OFS.Traversable, line 284, in unrestrictedTraverse\u000a   - __traceback_info__: ([], 'kss_generic_macros')\u000aKeyError: 'kss_generic_macros'</pre>\u000a</div>\u000a<p>kss_generic_macros \u304c\u7121\u3044\u3068\u3044\u3046\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3044\u308b\u3051\u3069\u3001\u307e\u3058\u3081\u306b\u8ffd\u3044\u304b\u3051\u308b\u3068\u6642\u9593\u304c\u304b\u304b\u308a\u305d\u3046\u3002\u591a\u5206\u30c7\u30b6\u30a4\u30f3\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u308b\u3069\u3053\u304b\u304c\u307e\u305a\u3044\u3093\u3060\u308d\u3046\u3068\u5f53\u305f\u308a\u3092\u4ed8\u3051\u3066\u3001portal_skins\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u30fc\u3067PloneDefault\u306bskin\u3092\u5207\u308a\u66ff\u3048\u3002\u3053\u308c\u3067Plone\u30b5\u30a4\u30c8\u3092\u8868\u793a\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\u30c7\u30b6\u30a4\u30f3\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3092\u5225\u540d\u3067\u4f5c\u3063\u3066\u304a\u3044\u3066\u3088\u304b\u3063\u305f\u30fc\u3002</p>\u000a</div>\u000a<div id=plone-3-1-7-3-3-1 class=section>\u000a<h2>Plone-3.1.7 -&gt; 3.3.1<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#plone-3-1-7-3-3-1 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>3.1.7\u304c\u3068\u308a\u3042\u3048\u305a\u52d5\u3044\u3066\u308b\u3063\u307d\u3044\u306e\u3067\u3001\u305d\u306e\u307e\u307e3.3.1\u3078Upgrade\u3092\u9032\u3081\u308b\u3002Plone-3.2\u4ee5\u964d\u306b\u3059\u308b\u306b\u306fbuildout\u5316\u3057\u305f\u307b\u3046\u304c\u4eca\u5f8c\u306e\u305f\u3081\u306b\u3082\u826f\u3044\u306e\u3067\u3001 plone.jp \u3084 takanory.net \u306a\u3069\u3092\u53c2\u8003\u306b\u3001buildout\u3067\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001ZopeSkel\u3092\u4f7f\u3063\u305fPlone3\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u65b9\u6cd5\u306a\u3069\u3092\u7df4\u7fd2\u3057\u3066\u304a\u304f\u3002\u5341\u5206\u7406\u89e3\u3067\u304d\u305f\u306e\u3067\u672c\u756a\u66f4\u65b0\u306b\u7740\u624b\u3002</p>\u000a<p>\u307e\u305a3.3.1\u7528\u306b\u65b0\u3057\u3044\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3002\u305d\u3053\u306bZopeSkel\u3067\u4f5c\u3063\u3066\u304a\u3044\u305fbuildout.cfg\u3068bootstrap.py\u3092\u6301\u3063\u3066\u884c\u304f\u3002</p>\u000a<p>buildout.cfg:</p>\u000a<div class=highlight-python><pre>[buildout]\u000aparts =\u000a    zope2\u000a    productdistros\u000a    instance\u000a    zopepy\u000a\u000a# Change the number here to change the version of Plone being used\u000aextends = http://dist.plone.org/release/3.3.2/versions.cfg\u000aversions = versions\u000a\u000a# Add additional egg download sources here. dist.plone.org contains archives\u000a# of Plone packages.\u000afind-links =\u000a    http://dist.plone.org/release/3.3.2\u000a    http://download.zope.org/ppix/\u000a    http://download.zope.org/distribution/\u000a    http://effbot.org/downloads\u000a\u000a# Add additional eggs here\u000aeggs =\u000a\u000a# Reference any eggs you are developing here, one per line\u000a# e.g.: develop = src/my.package\u000adevelop =\u000a\u000a\u000a[zope2]\u000a# For more information on this step and configuration options see:\u000a# http://pypi.python.org/pypi/plone.recipe.zope2install\u000arecipe = plone.recipe.zope2install\u000afake-zope-eggs = true\u000aadditional-fake-eggs =\u000a    ZODB3\u000aurl = ${versions:zope2-url}\u000alocation = /usr/local/www/Zope210\u000a\u000a\u000a# Use this section to download additional old-style products.\u000a# List any number of URLs for product tarballs under URLs (separate\u000a# with whitespace, or break over several lines, with subsequent lines\u000a# indented). If any archives contain several products inside a top-level\u000a# directory, list the archive file name (i.e. the last part of the URL,\u000a# normally with a .tar.gz suffix or similar) under 'nested-packages'.\u000a# If any archives extract to a product directory with a version suffix, list\u000a# the archive name under 'version-suffix-packages'.\u000a[productdistros]\u000a# For more information on this step and configuration options see:\u000a# http://pypi.python.org/pypi/plone.recipe.distros\u000arecipe = plone.recipe.distros\u000aurls =\u000anested-packages =\u000aversion-suffix-packages =\u000a\u000a[instance]\u000a# For more information on this step and configuration options see:\u000a# http://pypi.python.org/pypi/plone.recipe.zope2instance\u000arecipe = plone.recipe.zope2instance\u000azope2-location = ${zope2:location}\u000auser = admin:admin\u000ahttp-address = 8980\u000a\u000a# If you want Zope to know about any additional eggs, list them here.\u000a# This should include any development eggs you listed in develop-eggs above,\u000a# e.g. eggs = Plone my.package\u000aeggs =\u000a    Plone\u000a    ${buildout:eggs}\u000a\u000a\u000a# If you want to register ZCML slugs for any packages, list them here.\u000a# e.g. zcml = my.package my.other.package\u000azcml =\u000a\u000aproducts =\u000a    ${buildout:directory}/products\u000a    ${productdistros:location}\u000a\u000a[zopepy]\u000a# For more information on this step and configuration options see:\u000a# http://pypi.python.org/pypi/zc.recipe.egg\u000arecipe = zc.recipe.egg\u000aeggs = ${instance:eggs}\u000ainterpreter = zopepy\u000aextra-paths = ${zope2:location}/lib/python\u000ascripts = zopepy</pre>\u000a</div>\u000a<p>\u66f8\u304d\u63db\u3048\u305f\u7b87\u6240\u306f\u3001plone\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u5024\u30923.3.1\u304b\u30893.3.2\u306b\u3057\u305f\u304f\u3089\u3044\u3002</p>\u000a<p>buildout\u5b9f\u884c:</p>\u000a<div class=highlight-python><pre>$ sudo -u www -H python bootstrap.py\u000a$ sudo -u www -H bin/buildout -v</pre>\u000a</div>\u000a<p>\u65e2\u5b58\u306eProducts\u3092\u79fb\u884c:</p>\u000a<div class=highlight-python><pre>$ sudo -u www mkdir products\u000a$ sudo -u www cp -R ../old/Products/* products</pre>\u000a</div>\u000a<p>\u79fb\u884c\u3057\u306a\u304f\u3066\u826f\u3055\u305d\u3046\u306a\u30d7\u30ed\u30c0\u30af\u30c8\u3092\u524a\u9664:</p>\u000a<div class=highlight-python><pre>$ sudo -u www rm -Rf products/AdvancedQuery\u000a$ sudo -u www rm -Rf products/CallProfiler\u000a$ sudo -u www rm -Rf products/Hotfix_20070320\u000a$ sudo -u www rm -Rf products/WingDBG</pre>\u000a</div>\u000a<p>\u65e2\u5b58\u306evar\u3092\u79fb\u884c:</p>\u000a<div class=highlight-python><pre>$ sudo -u www cp ../old/var/Data.fs var/filestorage/\u000a$ sudo -u www cp ../old/var/counter* var/filestorage/</pre>\u000a</div>\u000a<p>\u8d77\u52d5:</p>\u000a<div class=highlight-python><pre>$ sudo -u www -H bin/instance fg</pre>\u000a</div>\u000a<p>\u3053\u3053\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002</p>\u000a<p>\u30a8\u30e9\u30fc\uff11: pymeter\u304c\u7121\u3044 -&gt; \u547c\u51fa\u5143\u3092\u524a\u9664:</p>\u000a<div class=highlight-python><pre>$ sudo -u www rm -Rf Products/ZWeatherApplet</pre>\u000a</div>\u000a<p>\u30a8\u30e9\u30fc\uff12: .python-egg/ \u3092\u4f5c\u308c\u306a\u3044:</p>\u000a<div class=highlight-python><pre>The following error occurred while trying to extract file(s) to the Python egg\u000acache:\u000a\u000a  [Errno 13] Permission denied: '/nonexistent'\u000a\u000aThe Python egg cache directory is currently set to:\u000a\u000a  /nonexistent/.python-eggs\u000a\u000aPerhaps your account does not have write access to this directory?  You can\u000achange the cache directory by setting the PYTHON_EGG_CACHE environment\u000avariable to point to an accessible directory.</pre>\u000a</div>\u000a<p>\u81ea\u5206\u306e\u74b0\u5883(FreeBSD)\u306ewww\u306fHOME\u304c/nonexistent\u3060\u3063\u305f\u306e\u3067\u3001\u3053\u308c\u3092vipw\u30b3\u30de\u30f3\u30c9\u3067/usr/local/www\u306b\u5909\u66f4\u3002\u5bfe\u5fdc\u65b9\u6cd5\u3068\u3057\u3066PYTHON_EGG_CACHE\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3046\u65b9\u6cd5\u3082\u3042\u308b\u3051\u3069\u3001rc.d\u3067\u8d77\u52d5\u3059\u308b\u6642\u306e\u3053\u3068\u3092\u8003\u3048\u3066...\u3044\u3084rc.d\u3067\u306e\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u74b0\u5883\u5909\u6570\u8a2d\u5b9a\u3059\u308c\u3070\u3044\u3044\u306e\u304b\uff1f\u307e\u3042\u3044\u3044\u3084\u3002</p>\u000a<p>HOME=/usr/local/www/ \u3067\u3053\u3053\u306bwww\u304c\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306e\u3042\u308b\u72b6\u614b\u306b\u3057\u3066\u518d\u5ea6\u8d77\u52d5:</p>\u000a<div class=highlight-python><pre>$ sudo -u www -H bin/instance fg</pre>\u000a</div>\u000a<p>\u8d77\u52d5\u3057\u305f\u306e\u3067migration\u5b9f\u884c. 3.1.7 -&gt; 3.3.2</p>\u000a<div class=highlight-python><pre>Plone Migration Tool at  /freia/taka/portal_migration\u000aResult of the attempt...\u000a\u000aDry run selected.\u000aStarting the migration from version: 3.1.7\u000aAttempting to upgrade from: 3.1.7\u000aUpgrade to: 3.2a1, completed\u000aAttempting to upgrade from: 3.2a1\u000aUpgrade to: 3.2rc1, completed\u000aAttempting to upgrade from: 3.2rc1\u000aUpgrade to: 3.2, completed\u000aAttempting to upgrade from: 3.2\u000aUpgrade to: 3.2.1, completed\u000aAttempting to upgrade from: 3.2.1\u000aUpgrade to: 3.2.2, completed\u000aAttempting to upgrade from: 3.2.2\u000aUpgrade to: 3.2.3, completed\u000aAttempting to upgrade from: 3.2.3\u000aUpgrade to: 3.3b1, completed\u000aAttempting to upgrade from: 3.3b1\u000aUpgrade to: 3.3rc1, completed\u000aAttempting to upgrade from: 3.3rc1\u000aUpgrade to: 3.3rc2, completed\u000aAttempting to upgrade from: 3.3rc2\u000aUpgrade to: 3.3rc3, completed\u000aAttempting to upgrade from: 3.3rc3\u000aUpgrade aborted\u000aError type: exceptions.AttributeError\u000aError value: 'NoneType' object has no attribute 'strip'\u000aFile "/var2/www/ZFreia_taka/eggs/Plone-3.3.2-py2.4.egg/Products/CMFPlone/MigrationTool.py", line 210, in upgrade newv, msgs = self._upgrade(newv)\u000aFile "/var2/www/ZFreia_taka/eggs/Plone-3.3.2-py2.4.egg/Products/CMFPlone/MigrationTool.py", line 321, in _upgrade res = function(self.aq_parent)\u000aFile "/var2/www/ZFreia_taka/eggs/Plone-3.3.2-py2.4.egg/Products/CMFPlone/migrations/v3_3/__init__.py", line 12, in three3_rc3_three3_rc4 cookCSSRegistries(portal)\u000aFile "/var2/www/ZFreia_taka/eggs/Plone-3.3.2-py2.4.egg/Products/CMFPlone/migrations/v3_3/__init__.py", line 25, in cookCSSRegistries resource.getCookedExpression()\u000aFile "/var2/www/ZFreia_taka/eggs/Products.ResourceRegistries-1.5.3-py2.4.egg/Products/ResourceRegistries/tools/BaseRegistry.py", line 115, in getCookedExpression expr = Expression(self._data['expression'])\u000aFile "/var2/www/ZFreia_taka/eggs/Products.CMFCore-2.1.2-py2.4.egg/Products/CMFCore/Expression.py", line 37, in __init__ if text.strip():\u000aEnd of upgrade path, migration has finished\u000aThe upgrade path did NOT reach current version\u000aMigration has failed\u000aDry run selected, transaction aborted</pre>\u000a</div>\u000a<p>\u307e\u305f\u30a8\u30e9\u30fc\uff01</p>\u000a<p>\u4eca\u5ea6\u306e\u30a8\u30e9\u30fc\u306fResourceRegistries\u95a2\u9023\u3089\u3057\u3044\u3002\u3053\u308c\u306fResourceRegistries/tools/BaseRegistry\u306egetCookedExpression\u30e1\u30bd\u30c3\u30c9\u5b9f\u88c5\u3092\u898b\u306a\u3044\u3068\u5206\u304b\u3089\u306a\u3044\u3002</p>\u000a<p>BaseRegistry.py \u306e getCookedExpression:</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=n>security</span><span class=o>.</span><span class=n>declarePublic</span><span class=p>(</span><span class=s>'getCookedExpression'</span><span class=p>)</span>\u000a<span class=k>def</span> <span class=nf>getCookedExpression</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>\u000a    <span class=c># Automatic inline migration of expressions</span>\u000a    <span class=k>if</span> <span class=s>'cooked_expression'</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>:</span>\u000a        <span class=n>expr</span> <span class=o>=</span> <span class=n>Expression</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=s>'expression'</span><span class=p>])</span>\u000a        <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=s>'cooked_expression'</span><span class=p>]</span> <span class=o>=</span> <span class=n>expr</span>\u000a    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=s>'cooked_expression'</span><span class=p>]</span>\u000a</pre></div>\u000a</div>\u000a<p>\u3053\u308c\u3092\u898b\u308b\u3068 self._data['expression'] \u304c None \u3092\u8fd4\u3057\u3066\u3044\u308b\u305f\u3081\u306b Expression \u30af\u30e9\u30b9\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3067\u5931\u6557\u3057\u3066\u3044\u308b\u3088\u3046\u3060\u3002\u3058\u3083\u3042 self._data['expression'] \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f\u4f55\u304c\u9069\u5207\u304b\u3068\u3044\u3046\u3068\u3001 BaseRegistry.py \u306e __init__ \u3092\u898b\u308b\u9650\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b''\u3067\u826f\u3044\u3089\u3057\u3044:</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=k>def</span> <span class=nf>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>id</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>\u000a    <span class=bp>self</span><span class=o>.</span><span class=n>_data</span> <span class=o>=</span> <span class=n>PersistentMapping</span><span class=p>()</span>\u000a    <span class=o>...</span>\u000a    <span class=n>expression</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>'expression'</span><span class=p>,</span> <span class=s>''</span><span class=p>)</span>\u000a    <span class=bp>self</span><span class=o>.</span><span class=n>setExpression</span><span class=p>(</span><span class=n>expression</span><span class=p>)</span>\u000a</pre></div>\u000a</div>\u000a<p>\u3068\u3044\u3046\u3053\u3068\u3067\u3001115\u884c\u76ee\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3066\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u3053\u3068\u306b\u3057\u305f:</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=k>def</span> <span class=nf>getCookedExpression</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>\u000a    <span class=c># Automatic inline migration of expressions</span>\u000a    <span class=k>if</span> <span class=s>'cooked_expression'</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>:</span>\u000a        <span class=bp>self</span><span class=o>.</span><span class=n>setExpression</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=s>'expression'</span><span class=p>]</span> <span class=ow>or</span> <span class=s>''</span><span class=p>)</span>\u000a    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_data</span><span class=p>[</span><span class=s>'cooked_expression'</span><span class=p>]</span>\u000a</pre></div>\u000a</div>\u000a<p>\u518d\u8d77\u52d5\u3057\u3066\u3082\u3063\u304b\u3044\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3(dry-run):</p>\u000a<div class=highlight-python><pre>Plone Migration Tool at  /freia/taka/portal_migration\u000aResult of the attempt...\u000a\u000aDry run selected.\u000aStarting the migration from version: 3.1.7\u000aAttempting to upgrade from: 3.1.7\u000aUpgrade to: 3.2a1, completed\u000aAttempting to upgrade from: 3.2a1\u000aUpgrade to: 3.2rc1, completed\u000aAttempting to upgrade from: 3.2rc1\u000aUpgrade to: 3.2, completed\u000aAttempting to upgrade from: 3.2\u000aUpgrade to: 3.2.1, completed\u000aAttempting to upgrade from: 3.2.1\u000aUpgrade to: 3.2.2, completed\u000aAttempting to upgrade from: 3.2.2\u000aUpgrade to: 3.2.3, completed\u000aAttempting to upgrade from: 3.2.3\u000aUpgrade to: 3.3b1, completed\u000aAttempting to upgrade from: 3.3b1\u000aUpgrade to: 3.3rc1, completed\u000aAttempting to upgrade from: 3.3rc1\u000aUpgrade to: 3.3rc2, completed\u000aAttempting to upgrade from: 3.3rc2\u000aUpgrade to: 3.3rc3, completed\u000aAttempting to upgrade from: 3.3rc3\u000aUpgrade to: 3.3rc4, completed\u000aAttempting to upgrade from: 3.3rc4\u000aUpgrade to: 3.3rc5, completed\u000aAttempting to upgrade from: 3.3rc5\u000aUpgrade to: 3.3, completed\u000aAttempting to upgrade from: 3.3\u000aUpgrade to: 3.3.1, completed\u000aAttempting to upgrade from: 3.3.1\u000aUpgrade to: 3.3.2, completed\u000aAttempting to upgrade from: 3.3.2\u000aMigration completed at version 3.3.2.\u000aEnd of upgrade path, migration has finished\u000aYour ZODB and Filesystem Plone instances are now up-to-date.\u000aDry run selected, transaction aborted</pre>\u000a</div>\u000a<p>\u6210\u529f\u3057\u305f\uff01\u672c\u5b9f\u884c:</p>\u000a<div class=highlight-python><pre>Plone Migration Tool at  /freia/taka/portal_migration\u000aResult of the attempt...\u000a\u000aStarting the migration from version: 3.1.7\u000aAttempting to upgrade from: 3.1.7\u000aUpgrade to: 3.2a1, completed\u000aAttempting to upgrade from: 3.2a1\u000aUpgrade to: 3.2rc1, completed\u000aAttempting to upgrade from: 3.2rc1\u000aUpgrade to: 3.2, completed\u000aAttempting to upgrade from: 3.2\u000aUpgrade to: 3.2.1, completed\u000aAttempting to upgrade from: 3.2.1\u000aUpgrade to: 3.2.2, completed\u000aAttempting to upgrade from: 3.2.2\u000aUpgrade to: 3.2.3, completed\u000aAttempting to upgrade from: 3.2.3\u000aUpgrade to: 3.3b1, completed\u000aAttempting to upgrade from: 3.3b1\u000aUpgrade to: 3.3rc1, completed\u000aAttempting to upgrade from: 3.3rc1\u000aUpgrade to: 3.3rc2, completed\u000aAttempting to upgrade from: 3.3rc2\u000aUpgrade to: 3.3rc3, completed\u000aAttempting to upgrade from: 3.3rc3\u000aUpgrade to: 3.3rc4, completed\u000aAttempting to upgrade from: 3.3rc4\u000aUpgrade to: 3.3rc5, completed\u000aAttempting to upgrade from: 3.3rc5\u000aUpgrade to: 3.3, completed\u000aAttempting to upgrade from: 3.3\u000aUpgrade to: 3.3.1, completed\u000aAttempting to upgrade from: 3.3.1\u000aUpgrade to: 3.3.2, completed\u000aAttempting to upgrade from: 3.3.2\u000aMigration completed at version 3.3.2.\u000aEnd of upgrade path, migration has finished\u000aYour ZODB and Filesystem Plone instances are now up-to-date.</pre>\u000a</div>\u000a<p>\u6210\u529f\uff01</p>\u000a<p>\u30b5\u30a4\u30c8\u8a2d\u5b9a\u753b\u9762\u306e\u8868\u793a:</p>\u000a<div class=highlight-python><pre>Plone 3.3.2\u000aCMF 2.1.2\u000aZope (Zope 2.10.9-final, python 2.4.4, freebsd7)\u000aPython 2.4.4 (#2, Oct 26 2008, 05:45:29) [GCC 4.2.1 20070719 [FreeBSD]]\u000aPIL 1.1.6</pre>\u000a</div>\u000a</div>\u000a<div id=id1 class=section>\u000a<h2>\u307e\u3068\u3081<a class=headerlink href=http://www.freia.jp/taka/blog/685/index.html#id1 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<ul>\u000a<li><dl class="first docutils">\u000a<dt>\u4f7f\u3063\u3066\u3044\u306a\u3044\u30d7\u30ed\u30c0\u30af\u30c8\u306f\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u524d\u306b\u5916\u3057\u3066\u304a\u304f</dt>\u000a<dd><ul class="first last simple">\u000a<li>CMFContentPanels (Plone3\u7cfb\u3067\u975e\u5bfe\u5fdc? \u8981\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u524d\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)</li>\u000a<li>AdvancedQuery (Plone\u672c\u4f53\u306b\u5165\u3063\u3066\u305f)</li>\u000a<li>CallProfiler (\u672c\u756a\u74b0\u5883\u306b\u306f\u3044\u3089\u306a\u3044)</li>\u000a<li>WingDBG (\u672c\u756a\u74b0\u5883\u306b\u306f\u3044\u3089\u306a\u3044)</li>\u000a<li>ZWeatherApplet (\u4ee5\u524d COREBlog1\u3068\u9023\u643a\u3057\u3066\u4f7f\u3063\u3066\u3044\u305f)</li>\u000a</ul>\u000a</dd>\u000a</dl>\u000a</li>\u000a<li><p class=first>\u6b8b\u3059\u30d7\u30ed\u30c0\u30af\u30c8\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30bd\u30fc\u30b9\u6539\u9020\u304c\u5fc5\u8981(import\u5143\u306e\u5909\u66f4\u306a\u3069)</p>\u000a</li>\u000a<li><p class=first>\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305fskin\u306f\u4e00\u5ea6\u6368\u3066\u308b\u65b9\u5411\u3067(\u697d\u306a\u306e\u3067).</p>\u000a</li>\u000a<li><p class=first>Products.ResourceRegistries/tools/BaseRegistry\u306e\u6539\u9020\u304c\u5fc5\u8981.</p>\u000a</li>\u000a<li><dl class="first docutils">\u000a<dt>\u6b8b\u4ef6\u3001\u6b21\u306e\u4f5c\u696d</dt>\u000a<dd><ul class="first last simple">\u000a<li>products\u306b\u30b3\u30d4\u30fc\u3057\u305f\u53e4\u3044\u30d7\u30ed\u30c0\u30af\u30c8\u3092buildout\u3078\u306e\u8a18\u8f09\u306b\u79fb\u884c\u3057\u3066upgrade\u3059\u308b</li>\u000a<li>\u4e0d\u8981\u306b\u306a\u3063\u305fProducts\u3092\u524a\u9664\u3057\u3066/Control_Panel/Products\u304b\u3089\u524a\u9664\u3059\u308b</li>\u000a</ul>\u000a</dd>\u000a</dl>\u000a</li>\u000a</ul>\u000a</div>\u000a</div>\u000a
p9
sS'unique_id'
p10
g7
sS'title'
p11
V2009/11/23 \u6e05\u6c34\u5dddWeb\u3092 Plone-2.5.2-1 \u304b\u3089 Plone-3.3.2 \u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9
p12
s.