(dp0
S'pubdate'
p1
cdatetime
datetime
p2
(S'\x07\xd6\x06\x0e\x00\x14\x1c\x00\x00\x00'
p3
tp4
Rp5
sS'link'
p6
Vhttp://www.freia.jp/taka/blog/350/index.html
p7
sS'description'
p8
V<div id=coreblog2 class=section>\u000a<h1>2006/06/14 COREBlog2\u30b9\u30d1\u30e0\u5bfe\u7b56(\u307e\u3068\u3081)<a class=headerlink href=http://www.freia.jp/taka/blog/350/index.html#coreblog2 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h1>\u000a<p><em>Category: 'Plone'</em></p>\u000a<p>\u6700\u8fd1\u4ed5\u4e8b\u306e\u5f71\u97ff\u3067 <strong>\u79c1</strong> \u304c\u304b\u306a\u308a\u758e\u304b\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u3093\u306a\u4e2d\u3001 <a class="reference external" href=http://takanory.net/>takanory.net\u3055\u3093\u304b\u3089trackback\u3092\u3082\u3089\u3063\u305f</a> \u306e\u3067\u3053\u308c\u306b\u53cd\u5fdc\u3057\u3066\u3001\u81ea\u5206\u304c\u884c\u3063\u3066\u3044\u308bCOREBlog2\u30b9\u30d1\u30e0\u5bfe\u7b56\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3059\u3002\u3053\u308c\u3092\u8aad\u3081\u3070\u4e00\u901a\u308a\u8a2d\u5b9a\u3067\u304d\u308b\u306f\u305a\uff1efor \u672a\u6765\u306e\u81ea\u5206</p>\u000a<p># \u53c2\u8003\uff1a <a class="reference external" href=http://www.freia.jp/taka/blog/306>spam\u3068\u306e\u6226\u3044\uff08\u56de\u9867\u7de8\uff09</a></p>\u000a<div id=buzzword class=section>\u000a<h2>\u30b9\u30d1\u30e0\u5bfe\u7b56\u5171\u901aBuzzWord\u30c1\u30a7\u30c3\u30af\u30b9\u30af\u30ea\u30d7\u30c8<a class=headerlink href=http://www.freia.jp/taka/blog/350/index.html#buzzword title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p><a class="reference external" href=http://www.freia.jp/taka/blog/coreblog27c216613spam-filter>\u4ee5\u524d\u306bblog\u306b\u66f8\u3044\u305f\u30b9\u30af\u30ea\u30d7\u30c8</a> \u3068\u540c\u4e00\u3067\u3059\u3002\u30b9\u30d1\u30de\u30fc\u304c\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u898b\u3066\u3044\u308b\u3068\u306f\u601d\u3044\u307e\u305b\u3093\u304c\u3001\u5ff5\u306e\u305f\u3081buzzword\u306f\u7701\u7565\u3057\u307e\u3059\u3002\u3068\u306f\u3044\u3048\u3001\u5927\u62b5\u306e\u30b9\u30d1\u30e0\u6295\u7a3f\u306b\u306f <tt class="docutils literal"><span class=pre>url=</span></tt> \u304b <tt class="docutils literal"><span class=pre>href</span></tt> \u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e2\u3064\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u307b\u3068\u3093\u3069\u9632\u3052\u308b\u3068\u601d\u3044\u307e\u3059\u3002</p>\u000a<p>\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092portal_skins/custom\u7b49\u306b\u7f6e\u304d\u307e\u3059\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Script (Python) "validateBuzzWords"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=text, moderated=True</span>\u000a<span class=c>##title=COREBlog2: buzzword checker</span>\u000a<span class=c>##</span>\u000a<span class=n>buzz_words</span> <span class=o>=</span> <span class=p>(</span>\u000a  <span class=s>'casino'</span><span class=p>,</span>\u000a<span class=p>)</span>\u000a\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=k>if</span> <span class=ow>not</span> <span class=n>moderated</span><span class=p>:</span>\u000a        <span class=k>return</span> <span class=n>moderated</span>\u000a\u000a    <span class=n>s</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>\u000a    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>buzz_words</span><span class=p>:</span>\u000a        <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>w</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>\u000a            <span class=n>moderated</span> <span class=o>=</span> <span class=bp>False</span>\u000a            <span class=k>break</span>\u000a    <span class=k>else</span><span class=p>:</span>\u000a        <span class=n>moderated</span> <span class=o>=</span> <span class=bp>True</span>\u000a\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>pass</span>\u000a\u000a<span class=k>return</span> <span class=n>moderated</span>\u000a</pre></div>\u000a</div>\u000a</div>\u000a<div id=id1 class=section>\u000a<h2>\u30b3\u30e1\u30f3\u30c8\u30b9\u30d1\u30e0\u5bfe\u7b56<a class=headerlink href=http://www.freia.jp/taka/blog/350/index.html#id1 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>\u307e\u305a\u306fcbaddComment\u306e\u76f4\u63a5\u547c\u3073\u51fa\u3057\u3092\u62d2\u5426\u3059\u308b\u3088\u3046\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u307e\u3059\u3002\u3053\u308c\u304c\u5fc5\u8981\u306b\u306a\u308b\u30b7\u30fc\u30f3\u306f\u6ec5\u591a\u306b\u306a\u3044\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u81ea\u5206\u306f\u55b0\u3089\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u5bfe\u7b56\u3057\u3066\u3044\u307e\u3059\u300222\u884c\u76ee\uff5e27\u884c\u76ee\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Controller Python Script "cbaddComment"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind state=state</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=</span>\u000a<span class=c>##title=COREBlog2: modify: refuce direct access</span>\u000a<span class=c>##</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFPlone</span> <span class=kn>import</span> <span class=n>transaction_note</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFCore.utils</span> <span class=kn>import</span> <span class=n>getToolByName</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFPlone.utils</span> <span class=kn>import</span> <span class=n>log</span>\u000a\u000a<span class=n>cbtool</span> <span class=o>=</span> <span class=n>getToolByName</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=s>'coreblog2_tool'</span><span class=p>)</span>\u000a\u000a<span class=n>REQUEST</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>REQUEST</span>\u000a<span class=n>form</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span>\u000a<span class=n>RESPONSE</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>REQUEST</span><span class=o>.</span><span class=n>RESPONSE</span>\u000a<span class=n>entry</span> <span class=o>=</span> <span class=n>context</span>\u000a\u000a<span class=c># refuse direct access.</span>\u000a<span class=k>if</span> <span class=n>script</span> <span class=ow>is</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s>'PUBLISHED'</span><span class=p>,</span><span class=bp>None</span><span class=p>):</span>\u000a    <span class=n>RESPONSE</span><span class=o>.</span><span class=n>setStatus</span><span class=p>(</span><span class=mi>403</span><span class=p>)</span>\u000a    <span class=k>return</span> <span class=s>'403 Forbidden'</span>\u000a    <span class=c>#return RESPONSE.redirect('403 Forbidden', 403)</span>\u000a\u000a<span class=k>if</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=s>'remember_cookie'</span><span class=p>):</span>\u000a    <span class=c>#Set cookie</span>\u000a    <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=p>[</span><span class=s>'author'</span><span class=p>,</span><span class=s>'email'</span><span class=p>,</span><span class=s>'url'</span><span class=p>]:</span>\u000a        <span class=k>if</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>\u000a            <span class=n>REQUEST</span><span class=o>.</span><span class=n>RESPONSE</span><span class=o>.</span><span class=n>setCookie</span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=n>key</span><span class=p>],</span>\u000a                        <span class=n>path</span><span class=o>=</span><span class=s>'/'</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>blog_object</span><span class=p>()</span><span class=o>.</span><span class=n>getPhysicalPath</span><span class=p>()),</span>\u000a                        <span class=n>expires</span><span class=o>=</span><span class=s>'Sun, 01-Dec-2099 12:00:00 GMT'</span><span class=p>)</span>\u000a\u000a<span class=c>#Try to add comment</span>\u000a<span class=n>entry</span><span class=o>.</span><span class=n>addComment2Entry</span><span class=p>(</span><span class=n>author</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'author'</span><span class=p>],</span><span class=n>email</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'email'</span><span class=p>],</span>\u000a                        <span class=n>url</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'url'</span><span class=p>],</span><span class=n>title</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'title'</span><span class=p>],</span>\u000a                        <span class=n>body</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'body'</span><span class=p>],</span><span class=n>REQUEST</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>)</span>\u000a\u000a<span class=c>#Send notify mail if need</span>\u000a<span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>getSend_comment_notification</span><span class=p>():</span>\u000a    <span class=k>try</span><span class=p>:</span>\u000a        <span class=n>to_addr</span>   <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getNotify_to</span><span class=p>()</span>\u000a        <span class=n>from_addr</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getNotify_to</span><span class=p>()</span>\u000a        <span class=n>msgbody</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=s>'comment_notify_body'</span><span class=p>)</span>\u000a        <span class=n>elements</span> <span class=o>=</span> <span class=p>{}</span>\u000a        <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=p>(</span><span class=s>'title'</span><span class=p>,</span><span class=s>'author'</span><span class=p>,</span><span class=s>'url'</span><span class=p>,</span><span class=s>'body'</span><span class=p>):</span>\u000a            <span class=k>if</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=n>k</span><span class=p>):</span>\u000a                <span class=n>elements</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=n>k</span><span class=p>]</span>\u000a            <span class=k>else</span><span class=p>:</span>\u000a                <span class=n>elements</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=s>''</span>\u000a        <span class=n>elements</span><span class=p>[</span><span class=s>'post_ip'</span><span class=p>]</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>getClientAddr</span><span class=p>()</span>\u000a        <span class=n>elements</span><span class=p>[</span><span class=s>'entry_url'</span><span class=p>]</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>absolute_url</span><span class=p>()</span>\u000a        <span class=n>msgbody</span> <span class=o>=</span> <span class=n>msgbody</span> <span class=o>%</span> <span class=p>(</span><span class=n>elements</span><span class=p>)</span>\u000a        <span class=n>msgsubject</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=s>'comment_notify_title'</span><span class=p>)</span>\u000a        <span class=n>mgsheader</span> <span class=o>=</span> <span class=s>"""To: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>From: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Mime-Version: 1.0</span>\u000a<span class=s>Content-Type: text/plain; Charset=utf-8</span>\u000a\u000a<span class=s>"""</span> <span class=o>%</span> <span class=p>(</span><span class=n>to_addr</span><span class=p>,</span><span class=n>from_addr</span><span class=p>)</span>\u000a        <span class=n>cbtool</span><span class=o>.</span><span class=n>send_mail</span><span class=p>(</span><span class=n>mgsheader</span><span class=o>+</span><span class=n>msgbody</span><span class=p>,</span> <span class=n>to_addr</span><span class=p>,</span> <span class=n>from_addr</span><span class=p>,</span> <span class=n>msgsubject</span><span class=p>)</span>\u000a\u000a    <span class=k>except</span> <span class=ne>Exception</span><span class=p>,</span><span class=n>e</span><span class=p>:</span>\u000a        <span class=n>log</span><span class=p>(</span> <span class=s>'COREBlog2/cbaddComment: '</span>\u000a                 <span class=s>'Some exception occured, </span><span class=si>%s</span><span class=s>'</span> <span class=o>%</span> <span class=n>e</span> <span class=p>)</span>\u000a\u000a<span class=c>#Set next action</span>\u000a<span class=n>state</span><span class=o>.</span><span class=n>setNextAction</span><span class=p>(</span><span class=s>'redirect_to:string:'</span><span class=p>)</span>\u000a\u000a<span class=c>#Display message for user</span>\u000a<span class=n>state</span><span class=o>.</span><span class=n>setKwargs</span><span class=p>({</span><span class=s>'portal_status_message'</span><span class=p>:</span><span class=s>'A comment successfully added.'</span><span class=p>})</span>\u000a<span class=k>return</span> <span class=n>state</span>\u000a\u000a\u000a\u000a<span class=k>return</span> <span class=n>state</span>\u000a</pre></div>\u000a</div>\u000a<p>validateComment\u306bBuzzWord\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u306f\u3001smap\u306e\u50be\u5411\u3084\u5143IP\u53ce\u96c6\u306e\u305f\u3081\u306bBuzzWord\u306b\u5f15\u3063\u304b\u304b\u3063\u305f\u5834\u5408\u306b\u3001\u6295\u7a3f\u5185\u5bb9\u3092\u7ba1\u7406\u8005\u306b\u30e1\u30fc\u30eb\u9001\u4fe1\u3057\u3001\u6295\u7a3f\u30d5\u30a9\u30fc\u30e0\u306b\u306f\u30a8\u30e9\u30fc\u3092\u8868\u793a\u3057\u3066\u6295\u7a3f\u81ea\u4f53\u306f\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Controller Validator "validateComment"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind state=state</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=</span>\u000a<span class=c>##title=COREBlog2: modify: add buzzword check</span>\u000a<span class=c>##</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFPlone</span> <span class=kn>import</span> <span class=n>transaction_note</span>\u000a<span class=n>REQUEST</span><span class=o>=</span><span class=n>context</span><span class=o>.</span><span class=n>REQUEST</span>\u000a<span class=n>moderated</span> <span class=o>=</span> <span class=bp>True</span>\u000a\u000a<span class=n>reqs</span> <span class=o>=</span> <span class=p>[</span><span class=s>'title'</span><span class=p>,</span><span class=s>'body'</span><span class=p>]</span>\u000a\u000a<span class=c>#See setting and append required field list</span>\u000a<span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>getComment_require_author</span><span class=p>():</span>\u000a    <span class=n>reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s>'author'</span><span class=p>)</span>\u000a\u000a<span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>getComment_require_email</span><span class=p>():</span>\u000a    <span class=n>reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s>'email'</span><span class=p>)</span>\u000a\u000a<span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>getComment_require_url</span><span class=p>():</span>\u000a    <span class=n>reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s>'url'</span><span class=p>)</span>\u000a\u000a<span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>reqs</span><span class=p>:</span>\u000a    <span class=k>if</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>REQUEST</span><span class=p>[</span><span class=n>key</span><span class=p>]:</span>\u000a        <span class=n>state</span><span class=o>.</span><span class=n>setError</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=s>'Please enter a value'</span><span class=p>,</span> <span class=n>new_status</span><span class=o>=</span><span class=s>'failure'</span><span class=p>)</span>\u000a\u000a<span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=p>[</span><span class=s>'title'</span><span class=p>,</span> <span class=s>'body'</span><span class=p>,</span> <span class=s>'author'</span><span class=p>,</span> <span class=s>'email'</span><span class=p>,</span> <span class=s>'url'</span><span class=p>]:</span>\u000a    <span class=k>if</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>\u000a        <span class=n>m</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>validateBuzzWords</span><span class=p>(</span><span class=n>REQUEST</span><span class=p>[</span><span class=n>key</span><span class=p>],</span> <span class=bp>True</span><span class=p>)</span>\u000a        <span class=k>if</span> <span class=ow>not</span> <span class=n>m</span><span class=p>:</span>\u000a            <span class=n>state</span><span class=o>.</span><span class=n>setError</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=s>'Please remove NG words.'</span><span class=p>,</span> <span class=n>new_status</span><span class=o>=</span><span class=s>'failure'</span><span class=p>)</span>\u000a            <span class=n>moderated</span> <span class=o>=</span> <span class=bp>False</span>\u000a\u000a<span class=c>#Try to send mail for Bad comment</span>\u000a<span class=k>if</span> <span class=ow>not</span> <span class=n>moderated</span><span class=p>:</span>\u000a    <span class=n>context</span><span class=o>.</span><span class=n>addCommentMail</span><span class=p>(</span>\u000a                        <span class=n>author</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>[</span><span class=s>'author'</span><span class=p>],</span><span class=n>email</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>[</span><span class=s>'email'</span><span class=p>],</span>\u000a                        <span class=n>url</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>[</span><span class=s>'url'</span><span class=p>],</span><span class=n>title</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>[</span><span class=s>'title'</span><span class=p>],</span>\u000a                        <span class=n>body</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>[</span><span class=s>'body'</span><span class=p>],</span> <span class=n>moderated</span><span class=o>=</span><span class=n>moderated</span><span class=p>,</span>\u000a                        <span class=n>remoteip</span><span class=o>=</span><span class=n>REQUEST</span><span class=o>.</span><span class=n>getClientAddr</span><span class=p>())</span>\u000a\u000a<span class=k>if</span> <span class=n>state</span><span class=o>.</span><span class=n>getErrors</span><span class=p>():</span>\u000a    <span class=n>state</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>portal_status_message</span><span class=o>=</span><span class=s>'Please correct the errors shown.'</span><span class=p>)</span>\u000a\u000a<span class=k>return</span> <span class=n>state</span>\u000a</pre></div>\u000a</div>\u000a<p>BuzzWord\u30b3\u30e1\u30f3\u30c8\u6642\u306e\u30e1\u30fc\u30eb\u9001\u4fe1\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\u3053\u308c\u306fCOREBlog2\u304c\u30e1\u30fc\u30eb\u9001\u4fe1\u306b\u3088\u308b\u30b3\u30e1\u30f3\u30c8\u901a\u77e5\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u524d\u306b\u4f5c\u3063\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u30a2\u30af\u30bb\u30b9\u5143IP\u3092\u901a\u77e5\u3057\u3066\u304f\u308c\u308b\u3042\u305f\u308a\u304c\u30b9\u30d1\u30e0\u5bfe\u7b56\u3063\u307d\u3044\u611f\u3058\u3067\u3059\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Script (Python) "addCommentMail"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=author,email,url,title,body,moderated,remoteip='',message=''</span>\u000a<span class=c>##title=</span>\u000a<span class=c>##</span>\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=n>mailhost</span><span class=o>=</span><span class=nb>getattr</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> \u005c\u000a                     <span class=n>context</span><span class=o>.</span><span class=n>superValues</span><span class=p>([</span><span class=s>'Secure Mail Host'</span><span class=p>,</span> <span class=s>'Mail Host'</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>,</span> <span class=s>"Mail Host object cant be found."</span>\u000a\u000a\u000a<span class=n>mMsg</span> <span class=o>=</span> <span class=s>"""To: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>From: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Mime-Version: 1.0</span>\u000a<span class=s>Content-Type: text/plain;</span>\u000a\u000a<span class=s>Moderate : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>ManageURL: http://www.freia.jp/taka/blog/</span><span class=si>%s</span><span class=s>/entry_comments</span>\u000a<span class=s>ViewURL  : http://www.freia.jp/taka/blog/</span><span class=si>%s</span><span class=s></span>\u000a<span class=s>RemoteIP : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Author   : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Title    : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>URL      : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>EMail    : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>EntryID  : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Body     :</span>\u000a<span class=si>%s</span><span class=s></span>\u000a\u000a<span class=s>Additional message:</span>\u000a<span class=si>%s</span><span class=s></span>\u000a<span class=s>"""</span>\u000a\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=n>to_addr</span>   <span class=o>=</span> <span class=s>"admin@example.jp"</span>\u000a    <span class=n>from_addr</span> <span class=o>=</span> <span class=s>"admin@example.jp"</span>\u000a    <span class=n>parent_id</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getId</span><span class=p>()</span>\u000a\u000a    <span class=n>mTo</span>   <span class=o>=</span> <span class=n>to_addr</span>\u000a    <span class=n>mFrom</span> <span class=o>=</span> <span class=n>from_addr</span>\u000a    <span class=n>mSubj</span> <span class=o>=</span> <span class=s>'blog: A comment </span><span class=si>%s</span><span class=s>'</span> <span class=o>%</span> <span class=p>(</span><span class=n>moderated</span> <span class=ow>and</span> <span class=s>'added!'</span> <span class=ow>or</span> <span class=s>'NEED MODERATE.'</span><span class=p>)</span>\u000a    <span class=n>mMsg</span>  <span class=o>=</span> <span class=n>mMsg</span> <span class=o>%</span> <span class=p>(</span><span class=n>to_addr</span><span class=p>,</span> <span class=n>from_addr</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>moderated</span><span class=p>),</span> <span class=n>parent_id</span><span class=p>,</span> <span class=n>parent_id</span><span class=p>,</span> \u005c\u000a                    <span class=n>remoteip</span><span class=p>,</span> <span class=n>author</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=n>parent_id</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>message</span> <span class=p>)</span>\u000a\u000a    <span class=n>mailhost</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>mMsg</span><span class=p>,</span> <span class=n>mTo</span><span class=p>,</span> <span class=n>mFrom</span><span class=p>,</span> <span class=n>mSubj</span><span class=p>)</span>\u000a\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>raise</span>\u000a</pre></div>\u000a</div>\u000a</div>\u000a<div id=id2 class=section>\u000a<h2>\u30c8\u30e9\u30c3\u30af\u30d0\u30c3\u30af\u30b9\u30d1\u30e0\u5bfe\u7b56<a class=headerlink href=http://www.freia.jp/taka/blog/350/index.html#id2 title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>tbping\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u3001validateBuzzWords\u3068\u30b9\u30d1\u30e0\u6642\u306e\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u547c\u3073\u51fa\u3059\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Script (Python) "tbping"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=</span>\u000a<span class=c>##title=Receive trackback: COREBlog2: modify: check buzzwords</span>\u000a<span class=c>##</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFCore.utils</span> <span class=kn>import</span> <span class=n>getToolByName</span>\u000a<span class=kn>from</span> <span class=nn>Products.CMFPlone.utils</span> <span class=kn>import</span> <span class=n>log</span>\u000a\u000a<span class=n>cbtool</span> <span class=o>=</span> <span class=n>getToolByName</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=s>'coreblog2_tool'</span><span class=p>)</span>\u000a\u000a<span class=n>REQUEST</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>REQUEST</span>\u000a<span class=n>form</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span>\u000a<span class=n>RESPONSE</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>REQUEST</span><span class=o>.</span><span class=n>RESPONSE</span>\u000a<span class=n>entry</span> <span class=o>=</span> <span class=n>context</span>\u000a\u000a<span class=n>excerpt</span> <span class=o>=</span> <span class=s>''</span>\u000a<span class=k>if</span> <span class=n>form</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=s>'excerpt'</span><span class=p>):</span>\u000a    <span class=n>excerpt</span> <span class=o>=</span> <span class=n>form</span><span class=p>[</span><span class=s>'excerpt'</span><span class=p>]</span>\u000a\u000a<span class=n>title</span> <span class=o>=</span> <span class=n>cbtool</span><span class=o>.</span><span class=n>convert_charcode</span><span class=p>(</span><span class=n>form</span><span class=p>[</span><span class=s>'title'</span><span class=p>])</span>\u000a<span class=n>blog_name</span> <span class=o>=</span> <span class=n>cbtool</span><span class=o>.</span><span class=n>convert_charcode</span><span class=p>(</span><span class=n>form</span><span class=p>[</span><span class=s>'blog_name'</span><span class=p>])</span>\u000a<span class=n>excerpt</span> <span class=o>=</span> <span class=n>cbtool</span><span class=o>.</span><span class=n>convert_charcode</span><span class=p>(</span><span class=n>excerpt</span><span class=p>)</span>\u000a\u000a<span class=c>#Try to add trackback</span>\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=c># !!!STAART modify by shimizukawa!!!</span>\u000a    <span class=n>moderated</span> <span class=o>=</span> <span class=bp>True</span>\u000a    <span class=k>for</span> <span class=n>text</span> <span class=ow>in</span> <span class=p>[</span><span class=n>title</span><span class=p>,</span> <span class=n>blog_name</span><span class=p>,</span> <span class=n>excerpt</span><span class=p>]:</span>\u000a        <span class=n>m</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>validateBuzzWords</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=bp>True</span><span class=p>)</span>\u000a        <span class=k>if</span> <span class=ow>not</span> <span class=n>m</span><span class=p>:</span>\u000a            <span class=n>state</span><span class=o>.</span><span class=n>setError</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=s>'Please remove NG words.'</span><span class=p>,</span> <span class=n>new_status</span><span class=o>=</span><span class=s>'failure'</span><span class=p>)</span>\u000a            <span class=n>moderated</span> <span class=o>=</span> <span class=bp>False</span>\u000a\u000a    <span class=c>#Try to send mail for Bad comment</span>\u000a    <span class=k>if</span> <span class=ow>not</span> <span class=n>moderated</span><span class=p>:</span>\u000a        <span class=n>context</span><span class=o>.</span><span class=n>addTrackbackMail</span><span class=p>(</span>\u000a                            <span class=n>title</span><span class=o>=</span><span class=n>title</span><span class=p>,</span> <span class=n>url</span><span class=o>=</span><span class=s>''</span><span class=p>,</span>\u000a                            <span class=n>blog_name</span><span class=o>=</span><span class=n>blog_name</span><span class=p>,</span>\u000a                            <span class=n>excerpt</span><span class=o>=</span><span class=n>excerpt</span><span class=p>,</span>\u000a                            <span class=n>moderated</span><span class=o>=</span><span class=n>moderated</span><span class=p>,</span>\u000a                            <span class=n>remoteip</span><span class=o>=</span><span class=n>REQUEST</span><span class=o>.</span><span class=n>getClientAddr</span><span class=p>(),</span>\u000a                            <span class=n>message</span><span class=o>=</span><span class=s>'NEED MODERATE'</span><span class=p>,)</span>\u000a        <span class=k>raise</span> <span class=s>'NEED MODERATE'</span>\u000a    <span class=c># !!!END modify by shimizukawa!!!</span>\u000a\u000a    <span class=c>#Send notify mail if need</span>\u000a    <span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>getSend_trackback_notification</span><span class=p>():</span>\u000a        <span class=k>try</span><span class=p>:</span>\u000a            <span class=n>to_addr</span>   <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getNotify_to</span><span class=p>()</span>\u000a            <span class=n>from_addr</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getNotify_to</span><span class=p>()</span>\u000a            <span class=n>msgbody</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=s>'trackback_notify_body'</span><span class=p>)</span>\u000a            <span class=n>elements</span> <span class=o>=</span> <span class=p>{}</span>\u000a            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=p>(</span><span class=s>'blog_name'</span><span class=p>,</span><span class=s>'title'</span><span class=p>,</span><span class=s>'excerpt'</span><span class=p>,</span><span class=s>'url'</span><span class=p>,</span><span class=s>'excerpt'</span><span class=p>):</span>\u000a                <span class=k>if</span> <span class=n>form</span><span class=o>.</span><span class=n>has_key</span><span class=p>(</span><span class=n>k</span><span class=p>):</span>\u000a                    <span class=n>elements</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=n>k</span><span class=p>]</span>\u000a                <span class=k>else</span><span class=p>:</span>\u000a                    <span class=n>elements</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=s>''</span>\u000a            <span class=n>elements</span><span class=p>[</span><span class=s>'post_ip'</span><span class=p>]</span> <span class=o>=</span> <span class=n>REQUEST</span><span class=o>.</span><span class=n>getClientAddr</span><span class=p>()</span>\u000a            <span class=n>elements</span><span class=p>[</span><span class=s>'entry_url'</span><span class=p>]</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>absolute_url</span><span class=p>()</span>\u000a            <span class=n>msgbody</span> <span class=o>=</span> <span class=n>msgbody</span> <span class=o>%</span> <span class=p>(</span><span class=n>elements</span><span class=p>)</span>\u000a            <span class=n>msgsubject</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>translate</span><span class=p>(</span><span class=s>'trackback_notify_title'</span><span class=p>)</span>\u000a            <span class=n>mgsheader</span> <span class=o>=</span> <span class=s>"""To: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>From: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Mime-Version: 1.0</span>\u000a<span class=s>Content-Type: text/plain; Charset=utf-8</span>\u000a\u000a<span class=s>"""</span> <span class=o>%</span> <span class=p>(</span><span class=n>to_addr</span><span class=p>,</span><span class=n>from_addr</span><span class=p>)</span>\u000a            <span class=n>cbtool</span><span class=o>.</span><span class=n>send_mail</span><span class=p>(</span><span class=n>mgsheader</span><span class=o>+</span><span class=n>msgbody</span><span class=p>,</span> <span class=n>to_addr</span><span class=p>,</span> <span class=n>from_addr</span><span class=p>,</span> <span class=n>msgsubject</span><span class=p>)</span>\u000a        <span class=k>except</span> <span class=ne>Exception</span><span class=p>,</span><span class=n>e</span><span class=p>:</span>\u000a            <span class=n>log</span><span class=p>(</span> <span class=s>'COREBlog2/tbping: '</span>\u000a                     <span class=s>'Some exception occured, </span><span class=si>%s</span><span class=s>'</span> <span class=o>%</span> <span class=n>e</span> <span class=p>)</span>\u000a\u000a    <span class=n>entry</span><span class=o>.</span><span class=n>addTrackback2Entry</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=n>title</span><span class=p>,</span><span class=n>url</span><span class=o>=</span><span class=n>form</span><span class=p>[</span><span class=s>'url'</span><span class=p>],</span>\u005c\u000a                            <span class=n>blog_name</span><span class=o>=</span><span class=n>blog_name</span><span class=p>,</span><span class=n>excerpt</span><span class=o>=</span><span class=n>excerpt</span><span class=p>)</span>\u000a\u000a    <span class=k>return</span> <span class=n>context</span><span class=o>.</span><span class=n>tbping_result</span><span class=p>(</span><span class=n>client</span><span class=o>=</span><span class=n>context</span><span class=p>,</span><span class=n>REQUEST</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>,</span>\u005c\u000a                                        <span class=n>error_code</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span><span class=n>message</span><span class=o>=</span><span class=s>'Thanks :-)'</span><span class=p>)</span>\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>return</span> <span class=n>context</span><span class=o>.</span><span class=n>tbping_result</span><span class=p>(</span><span class=n>client</span><span class=o>=</span><span class=n>context</span><span class=p>,</span><span class=n>REQUEST</span><span class=o>=</span><span class=n>REQUEST</span><span class=p>,</span>\u005c\u000a                                    <span class=n>error_code</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span><span class=n>message</span><span class=o>=</span><span class=s>'Error occured!'</span><span class=p>)</span>\u000a</pre></div>\u000a</div>\u000a<p>addCommentMail\u3068\u307b\u307c\u540c\u4e00\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3002\u30c8\u30e9\u30c3\u30af\u30d0\u30c3\u30af\u7528\u3002\u82b8\u306e\u306a\u3044\u30b3\u30d4\u30da\u30b3\u30fc\u30c9\u3002</p>\u000a<div class=highlight-python><div class=highlight><pre><span class=c>## Script (Python) "addTrackbackMail"</span>\u000a<span class=c>##bind container=container</span>\u000a<span class=c>##bind context=context</span>\u000a<span class=c>##bind namespace=</span>\u000a<span class=c>##bind script=script</span>\u000a<span class=c>##bind subpath=traverse_subpath</span>\u000a<span class=c>##parameters=title,url,blog_name,excerpt,moderated,remoteip='',message=''</span>\u000a<span class=c>##title=</span>\u000a<span class=c>##</span>\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=n>mailhost</span><span class=o>=</span><span class=nb>getattr</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> \u005c\u000a                     <span class=n>context</span><span class=o>.</span><span class=n>superValues</span><span class=p>([</span><span class=s>'Secure Mail Host'</span><span class=p>,</span> <span class=s>'Mail Host'</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>,</span> <span class=s>"Mail Host object cant be found."</span>\u000a\u000a<span class=n>mMsg</span> <span class=o>=</span> <span class=s>"""To: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>From: </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Mime-Version: 1.0</span>\u000a<span class=s>Content-Type: text/plain;</span>\u000a\u000a<span class=s>Moderate : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>ManageURL: http://www.freia.jp/taka/blog/</span><span class=si>%s</span><span class=s>/entry_trackbacks</span>\u000a<span class=s>ViewURL  : http://www.freia.jp/taka/blog/</span><span class=si>%s</span><span class=s></span>\u000a<span class=s>RemoteIP : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Title    : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>URL      : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>BlogName : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>EntryID  : </span><span class=si>%s</span><span class=s></span>\u000a<span class=s>Excerpt  :</span>\u000a<span class=si>%s</span><span class=s></span>\u000a\u000a<span class=s>Additional message:</span>\u000a<span class=si>%s</span><span class=s></span>\u000a<span class=s>"""</span>\u000a\u000a<span class=k>try</span><span class=p>:</span>\u000a    <span class=n>to_addr</span>   <span class=o>=</span> <span class=s>"admin@example.jp"</span>\u000a    <span class=n>from_addr</span> <span class=o>=</span> <span class=s>"admin@example.jp"</span>\u000a    <span class=n>parent_id</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>getId</span><span class=p>()</span>\u000a\u000a    <span class=n>mTo</span>   <span class=o>=</span> <span class=n>to_addr</span>\u000a    <span class=n>mFrom</span> <span class=o>=</span> <span class=n>from_addr</span>\u000a    <span class=n>mSubj</span> <span class=o>=</span> <span class=s>'blog: A trackback </span><span class=si>%s</span><span class=s>'</span> <span class=o>%</span> <span class=p>(</span><span class=n>moderated</span> <span class=ow>and</span> <span class=s>'added!'</span> <span class=ow>or</span> <span class=s>'NEED MODERATE.'</span><span class=p>)</span>\u000a    <span class=n>mMsg</span>  <span class=o>=</span> <span class=n>mMsg</span> <span class=o>%</span> <span class=p>(</span><span class=n>to_addr</span><span class=p>,</span> <span class=n>from_addr</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>moderated</span><span class=p>),</span> <span class=n>parent_id</span><span class=p>,</span> <span class=n>parent_id</span><span class=p>,</span> \u005c\u000a                    <span class=n>remoteip</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=n>blog_name</span><span class=p>,</span> <span class=n>parent_id</span><span class=p>,</span> <span class=n>excerpt</span><span class=p>,</span> <span class=n>message</span> <span class=p>)</span>\u000a\u000a    <span class=n>mailhost</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>mMsg</span><span class=p>,</span> <span class=n>mTo</span><span class=p>,</span> <span class=n>mFrom</span><span class=p>,</span> <span class=n>mSubj</span><span class=p>)</span>\u000a\u000a<span class=k>except</span><span class=p>:</span>\u000a    <span class=k>raise</span>\u000a</pre></div>\u000a</div>\u000a</div>\u000a<div id=apacheip class=section>\u000a<h2>Apache\u306eIP\u30a2\u30c9\u30ec\u30b9\u5236\u9650<a class=headerlink href=http://www.freia.jp/taka/blog/350/index.html#apacheip title=\u3053\u306e\u30d8\u30c3\u30c9\u30e9\u30a4\u30f3\u3078\u306e\u30d1\u30fc\u30de\u30ea\u30f3\u30af></a></h2>\u000a<p>\u30ed\u30b0\u306e\u51fa\u529b\u3092\u6a19\u6e96\u306e\u30a2\u30af\u30bb\u30b9\u3068\u5225\u306b\u3057\u305f\u308a\u3001\u30a2\u30af\u30bb\u30b9\u6642\u306bZope\u306b\u30a2\u30af\u30bb\u30b9\u306b\u884c\u304b\u306a\u3044\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u308a\u3057\u3066\u307e\u3059\u3002httpd.conf\u306e\u66f8\u304d\u65b9\u3092\u5168\u7136\u8abf\u67fb\u3057\u3066\u306a\u3044\u306e\u3067\u5197\u9577\u306a\u611f\u3058\u3067\u3059\u3002\u3042\u3068\u672c\u5f53\u306f\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u3058\u3083\u306a\u304f\u3066403\u3092\u8fd4\u3059\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u3002</p>\u000a<div class=highlight-python><pre>SetEnvIf Remote_addr "(24\u005c.244\u005c.170\u005c.180|81\u005c.177\u005c.8\u005c.26)" spam1\u000aCustomLog /var/log/httpd/www.freia.jp-access.log combined env=!spam1\u000aCustomLog /var/log/httpd/www.freia.jp-access-spam1.log combined env=spam1\u000aErrorLog /var/log/httpd/www.freia.jp-error.log\u000a\u000aRewriteEngine On\u000a\u000a# for spam filtering.\u000aRewriteCond %{REMOTE_HOST}  ^(24\u005c.244\u005c.170\u005c.180|81\u005c.177\u005c.8\u005c.26)\u000aRewriteRule ^/(.*) http://localhost:80/underconstruction/ [P,L]\u000a\u000a# rewrite standard zope server.\u000aRewriteRule ^/(.*) http://localhost:8080/VirtualHostBase/http/www.freia.jp:80/VirtualHostRoot/$1 [P,L]</pre>\u000a</div>\u000a<p>\u4e0a\u8a18\u306ehttpd.conf\u3001\u898b\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306bIP\u30a2\u30c9\u30ec\u30b9\u5236\u9650\u30922\u3064\u3060\u3051\u66f8\u3044\u3066\u3044\u307e\u3059\u304c\u3001\u672c\u5f53\u306f\u4ee5\u4e0b\u306eIP\u3092\u5236\u9650\u3057\u3066\u3044\u307e\u3059\u3002</p>\u000a<blockquote>\u000a<div>24.244.170.180\u000a65.214.44.212\u000a66.246.218.107\u000a69.50.167.122\u000a81.177.7.108\u000a81.177.7.154\u000a81.177.7.37\u000a81.177.7.81\u000a81.177.8.26\u000a85.255.117.18\u000a194.117.134.72\u000a195.39.170.102\u000a200.79.91.5\u000a202.56.253.184\u000a209.190.4.10\u000a209.190.4.106\u000a209.67.219.178</div></blockquote>\u000a</div>\u000a</div>\u000a
p9
sS'unique_id'
p10
g7
sS'title'
p11
V2006/06/14 COREBlog2\u30b9\u30d1\u30e0\u5bfe\u7b56(\u307e\u3068\u3081)
p12
s.